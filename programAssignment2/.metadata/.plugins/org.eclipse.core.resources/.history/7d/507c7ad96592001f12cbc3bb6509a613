package programAssignment2;
import java.util.Scanner;
//Node structure
class Node {
	int orderID;
	String bookName;
	int height;
	Node left;
	Node right;
	
	Node(int value){
		orderID = value;
		bookName = "default";
		height = 1;
	}
}
class AVLTree {
	Node root;
	//get height of the node
	int nodeHeight(Node n) {
		if(n == null)
			return 0;
		return n.height;
	}
	//get maximum of 2 numbers
	int max(int number1, int number2) {
		return (number1 < number2) ? number1 : number2;
	}
	//update height of the node
	void updateHeight(Node n) {
		n.height = 1+ Math.max(nodeHeight(n.left), nodeHeight(n.right));
	}
	//balance of the node
	int balance(Node n) {
		if(n == null) {
			return 0;
		}
		return (nodeHeight(n.left) - nodeHeight(n.right));
	}
	//left rotate
	Node rotateLeft(Node x) {
		Node y = x.right;
		Node T2 = y.left;
		
		y.left = x;
		x.right = T2;
		
		updateHeight(x);
		updateHeight(y);
		
		return y;
	}
	//right rotate
	Node rotateRight(Node x) {
		Node y = x.left;
		Node T2 = y.right;
		
		y.right = x;
		x.left = T2;
		
		updateHeight(y);
		updateHeight(x);
		
		return x;
	}
	//balance the tree
	Node balanceTree(Node n) {
		updateHeight(n);
		
		int balance = balance(n);
		
		if(balance > 1) {
			//right
			if(balance(n.right) < 0) {
				//right left
				n.right = rotateRight(n.right);
				return rotateLeft(n);
			}
		else //RR
			return rotateLeft(n);	
		}
		if(balance < -1) {
			//left
			if(balance(n.left) > 0) {
				//left right
				n.left = rotateLeft(n.left);
				return rotateRight(n);
			}
		else //LL
			return rotateRight(n);	
		}
		return n;
	}
	//Insert
	Node insertNode(Node n, int key) {
		if(n == null) {
			return new Node(key);
		}
		else if(key < n.orderID) {
			n.left = insertNode(n.left, key);
		}
		else {
			n.right = insertNode(n.right, key);
		}
		return balanceTree(n);
	}
	//return the next left child
	Node mostLeftChild(Node n) {
		if(n.left != null)
			return mostLeftChild(n.left);
		else
			return n;
	}
	//remove
	Node removeNode(Node n, int key) {
	    if (n == null) {
	        return n;
	    } else if (n.orderID > key) {
	        n.left = removeNode(n.left, key);
	    } else if (n.orderID < key) {
	        n.right = removeNode(n.right, key);
	    } else {
	        if (n.left == null || n.right == null) {
	            n = (n.left == null) ? n.right : n.left;
	        } else {
	            Node mostLeftChild = mostLeftChild(n.right);
	            n.orderID = mostLeftChild.orderID;
	            n.right = removeNode(n.right, n.orderID);
	        }
	    }
	    if (n != null) {
	        n = balanceTree(n);
	    }
	    return n;
	}
	//find
	Node findNode(int key) {
	    Node current = root;
	    while (current != null) {
	        if (current.orderID == key) {
	            break;
	        }
	        current = current.orderID < key ? current.right : current.left;
	    }
	    return current;
	}
	 // Utility function for insertion of node
    void add(int key)
    {
        if (findNode(key) == null)
        {
            root = insertNode(root , key);
            System.out.println("Insertion successful");
        }

        else
            System.out.println("\nKey with the entered value already exists in the tree");
    }

    int search(int key)
    {
        if(findNode(key) == null)
            return 0;
        else
            return 1;
    }

    // Utility function for deletion of node
    void delete(int key)
    {
        if (findNode(key) != null)
        {
            root = removeNode(root , key);
            System.out.println("\nDeletion successful ");
        }

        else
            System.out.println("\nNo node with entered value found in tree");
    }

    void InOrder(Node root)
    {
        if(root == null)
        {
            System.out.println("\nNo nodes in the tree");
            return;
        }

        if(root.left != null)
            InOrder(root.left);
        System.out.print(root.orderID + " ");
        if(root.right != null)
            InOrder(root.right);

    }

    void PreOrder(Node root)
    {
        if(root == null)
        {
            System.out.println("No nodes in the tree");
            return;
        }

        System.out.print(root.bookName + " ");
        if(root.left != null)
            PreOrder(root.left);
        if(root.right != null)
            PreOrder(root.right);

    }

    void PostOrder(Node key)
    {
        if(key == null)
        {
            System.out.println("No nodes in the tree");
            return;
        }


        if(key.left != null)
            PostOrder(key.left);
        if(key.right != null)
            PostOrder(key.right);
        System.out.print(key.bookName + " ");

    }
}